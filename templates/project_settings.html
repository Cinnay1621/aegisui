<!-- aegisui/templates/project_settings.html -->
{% extends "base.html" %}
{% block content %}
<h3>Projekteinstellungen: {{ project['name'] }}</h3>

<div class="row">
  <div class="col-md-6">
    <h5>Mitglieder</h5>
    <table class="table table-sm table-striped">
      <thead><tr><th>Nutzer</th><th>Rolle</th><th>Aktionen</th></tr></thead>
      <tbody>
      {% for m in members %}
        <tr>
          <td>{{ m['username'] }}</td>
          <td>
            <form method="post" class="d-inline">
              <input type="hidden" name="action" value="update">
              <input type="hidden" name="user_id" value="{{ m['user_id'] }}">
			  <select name="role" class="form-control form-control-sm" style="width:120px; display:inline;" required>
				  <option value="guest" {% if m['role'] == 'guest' %}selected{% endif %}>guest</option>
				  <option value="member" {% if m['role'] == 'member' %}selected{% endif %}>member</option>
				  <option value="manager" {% if m['role'] == 'manager' %}selected{% endif %}>manager</option>
			  </select>
              <button class="btn btn-sm btn-primary" type="submit">Setzen</button>
            </form>
          </td>
          <td>
            <form method="post" class="d-inline" onsubmit="return confirm('Entfernen?');">
              <input type="hidden" name="action" value="remove">
              <input type="hidden" name="user_id" value="{{ m['user_id'] }}">
              <button class="btn btn-sm btn-danger" type="submit">Entfernen</button>
            </form>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="col-md-6">
    <h5>Neues Mitglied hinzufügen</h5>
    <form method="post" class="mb-3">
      <div class="row g-2">
        <div class="col-8">
          <select name="user_id" class="form-control" required>
            {% for u in users %}
              <option value="{{ u['id'] }}">{{ u['username'] }} ({{ u['role'] }})</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-4">
          <select name="role" class="form-control" required>
            <option value="member">member</option>
            <option value="manager">manager</option>
          </select>
        </div>
      </div>
      <input type="hidden" name="action" value="add">
      <button class="btn btn-success mt-2" type="submit">Hinzufügen / Aktualisieren</button>
    </form>
  </div>
</div>
{% endblock %}
